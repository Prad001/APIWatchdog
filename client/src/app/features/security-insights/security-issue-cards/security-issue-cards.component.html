<div class="rounded-xl shadow-md  text-gray-100 border border-gray-700 mb-4 p-4" style="background-color: #3d3277;">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h3 class="text-lg font-semibold flex items-center gap-2">
        <span *ngIf="issue.severity === 'High'" class="text-red-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
</svg>
</span>
        <span *ngIf="issue.severity === 'Medium'" class="text-yellow-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
</svg>
</span>
        <span *ngIf="issue.severity === 'Low'" class="text-blue-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
</svg>
</span>
        {{ issue.title }}
      </h3>
      <p class="text-sm text-gray-300 mt-1">Endpoint: <code class=" px-2 py-1 rounded" style="background-color: #271031;">{{ issue.endpoint }}</code></p>
    </div>

    <span class="px-3 py-1 text-xs rounded-lg font-bold" [ngClass]="severityColor">
      {{ issue.severity }}
    </span>
  </div>

  <!-- Description -->
  <p class="mt-2 text-sm">{{ issue.recommendation }}</p>

  <!-- Category Tag -->
  <div class="mt-2">
    <span class="text-xs font-semibold px-2 py-1 rounded bg-purple-800 text-purple-200">
      {{ issue.tag }}
    </span>
  </div>

  <!-- Expand/Collapse -->
<div class="mt-4">
  <button
    class="flex items-center gap-2 text-sm text-blue-300 hover:text-blue-200 cursor-pointer"
    (click)="toggleDetails()"
  >
    <ng-container *ngIf="expanded; else collapsed">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
           stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
      </svg>
      <span>Hide Details</span>
    </ng-container>

    <ng-template #collapsed >
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
           stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
      </svg>
      <span>View Details</span>
    </ng-template>
  </button>
</div>


  <!-- Expanded Details -->
  <div *ngIf="expanded" class="mt-3  p-3 rounded-lg" style="background-color: #30275D;">
    <h4 class="font-semibold mb-2">Remediation Steps:</h4>
    <ul class="list-decimal list-inside space-y-1 text-sm text-gray-300">
      <li *ngFor="let step of issue.remediationSteps">{{ step }}</li>
    </ul>

    <div *ngIf="issue.resourceLink" class="mt-3">
      <a [href]="issue.resourceLink" target="_blank" class="text-blue-400 underline text-sm">ðŸ”— Learn more</a>
    </div>
  </div>
</div>
